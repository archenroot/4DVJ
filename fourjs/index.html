<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>four.js</title>
    <link rel="stylesheet" type="text/css" href="../_lib/css/style-liquid.css" />
    <link rel="stylesheet" type="text/css" href="./css/custom-style.css" />
    <script type="text/javascript" src="../_lib/js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="../_lib/js/easeljs-0.7.1.min.js"></script>
    <!--<script type="text/javascript" src="../lib/js/movieclip-0.7.1.min.js"></script>
    <script type="text/javascript" src="../_lib/js/soundjs-0.5.2.min.js"></script>
    <script type="text/javascript" src="../_lib/js/tweenjs-0.5.1.min.js"></script>
    <script type="text/javascript" src="../_lib/js/preloadjs-0.4.1.min.js"></script>-->
    <script type="text/javascript" src="../_lib/js/combinatorics.js"></script>
    <script type="text/javascript" src="../_lib/js/gl-matrix-min.js"></script>
    <script type="text/javascript" src="../_lib/js/three.js"></script>
    <script type="text/javascript" src="../_lib/js/stats.min.js"></script>
    <script type="text/javascript" src="../_lib/js/dat.gui.min.js"></script>

    <!-- cusotm plugins -->
    <script type="text/javascript" src="./js/lodash.min.js"></script>
    <script type="text/javascript" src="./js/jquery.mousewheel.min.js"></script>

    <!-- shader -->
    <script id="4DVertexShader" type="x-shader/x-vertex">

        //varying float ip;
        //varying float direction;

        uniform mat4 matrix4D;
        uniform float distance;
        uniform int stereograph;

        attribute float positionW;

        varying vec2 vUv;

        varying float intensityA;
        varying float intensityB;

        void main() {

            vUv = uv;

            intensityA = positionW * 0.5 + 0.5;
            intensityB = position.z * 0.5 + 0.5;

            // transform in 4D
            vec4 tPosition = matrix4D * vec4( position, positionW );

            // if stereograph flag is true, normalize vertices
            if ( stereograph == 1 ) {

                tPosition = normalize( tPosition );
            }

            // perspective projection from [0, 0, 0, distance] to XYZ hyperplane
            float d = distance / ( distance - tPosition.w );

            vec3 pPosition = tPosition.xyz * d;

            gl_Position = projectionMatrix * modelViewMatrix * vec4( pPosition, 1.0 );
        }

    </script>

    <script id="4DFragmentShader" type="x-shader/x-fragment">

        precision mediump float;

        // uniforms

        uniform float opacity;

        uniform vec3 colorA0;
        uniform vec3 colorA1;
        uniform vec3 colorB0;
        uniform vec3 colorB1;

        uniform sampler2D texture;


        // varyings

        varying vec2 vUv;

        varying float intensityA;
        varying float intensityB;

        varying float stripe;


        void  main( void ) {

            vec3 color = mix( colorA0, colorA1, intensityA ) + mix( colorB0, colorB1, intensityB );

            // overlay stripe
            if ( mod( (vUv.x+vUv.y), 0.1 ) > 0.05 ) {
                color = color * 0.95;
            }

            gl_FragColor = vec4( color, opacity );
        }
    </script>

    <script id="PostEffectVertexShader" type="x-shader/x-vertex">
        varying vec2 vUv;
 
        void main() {

            vUv = uv;
            gl_Position = projectionMatrix * modelViewMatrix *
            vec4(position, 1.0);
        }

    </script>

    <script id="PostEffectFragmentShader" type="x-shader/x-fragment">

        

    </script>

    <!-- core -->
    <script type="text/javascript" src="./js/threejs/core/Geometry4D.js"></script>

    <!-- renderer -->
    <!--<script type="text/javascript" src="./js/threejs/renderer/webgl/WebGLExtensions.js"></script>-->
    <script type="text/javascript" src="./js/threejs/renderer/WebGLRenderer4D.js"></script>

    <!-- objects -->
    <!--<script type="text/javascript" src="./js/threejs/objects/Group.js"></script>-->
    <script type="text/javascript" src="./js/threejs/objects/Mesh4D.js"></script>


    <!-- Materials -->
    <script type="text/javascript" src="./js/threejs/materials/ShaderMaterial4D.js"></script>

    <!-- Frame -->
    <script type="text/javascript" src="./js/threejs/frame/Frame4D.js"></script>
    <script type="text/javascript" src="./js/threejs/frame/Regular600CellFrame.js"></script>

    <!-- extra -->
    <script type="text/javascript" src="./js/threejs/extras/geometries/Regular5Cell.js"></script>
    <script type="text/javascript" src="./js/threejs/extras/geometries/Regular8Cell.js"></script>
    <script type="text/javascript" src="./js/threejs/extras/geometries/Regular16Cell.js"></script>
    <script type="text/javascript" src="./js/threejs/extras/geometries/Regular24Cell.js"></script>
    <script type="text/javascript" src="./js/threejs/extras/geometries/Regular600Cell.js"></script>
    <script type="text/javascript" src="./js/threejs/extras/geometries/CliffordTorus.js"></script>
    <script type="text/javascript" src="./js/main.js"></script>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="description">
        ドラッグで視点の回転, スクロールでメッシュの4次元方向への回転
    </div>
</body>
</html>